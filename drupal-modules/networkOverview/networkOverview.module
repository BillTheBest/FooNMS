<?php

function networkOverview_help($path, $arg)
{
	switch($path)
	{
	case 'admin/help#networkOverview':	//Main module help for the networkStatus module
		$output = "";
		$output .= '<p>' . t('The network status table can be generated by calling generateNetworkStatusTable(\$dbname); where \$dbname is the name of a database configured in the drupal config file.', array()) . '</p>';
		$output .= '<p>' . t('This module is largely independent of the other modules than make up the main FooNMS installation. It is basically for guests.', array()) . '</p>';
	}
}

function generateNetworkOverview($dbname)
{
	echo '<table>';
	echo '<tr><th>Device</th><th>IPv4</th><th>IPv6</th><th>HTTP</th><th>SMTP</th><th>POP3</th><th>IMAP</th><th>DNS</th></tr>';
	
	## You'll need to change this!
	$hosts = array("carbon.mammoth.nsw.au.fooproject.net","iron.grand.fl.us.fooproject.net","www.google.com","ipv6.google.com");
	

	foreach($hosts as $host)
	{
		echo '<tr><td>'.$host.'</td>';

		$unused = array();
		
		exec('ping -c1 '.$host,$unused,$return);
		if($return==0)
		{
			echo '<td><img src="http://fooproject.com.au/misc/message-16-ok.png" alt="Up" /></td>';
		} else {
			echo '<td><img src="http://fooproject.com.au/misc/message-16-error.png" alt="Down" /></td>';
		}

		exec('ping6 -c1 '.$host,$unused,$return);
		if($return==0)
		{
			echo '<td><img src="http://fooproject.com.au/misc/message-16-ok.png" alt="Up" /></td>';
		} else {
			echo '<td><img src="http://fooproject.com.au/misc/message-16-error.png" alt="Down" /></td>';
		}
		
		$http = file('http://'.$host.'/');
		if($http!=FALSE)
		{
			echo '<td><img src="http://fooproject.com.au/misc/message-16-ok.png" alt="Up" /></td>';
		} else {
			echo '<td><img src="http://fooproject.com.au/misc/message-16-error.png" alt="Down" /></td>';
		}
		
		echo '<td><img src="http://fooproject.com.au/misc/message-16-help.png" alt="No idea" /></td>';
		echo '<td><img src="http://fooproject.com.au/misc/message-16-help.png" alt="No idea" /></td>';
		echo '<td><img src="http://fooproject.com.au/misc/message-16-help.png" alt="No idea" /></td>';
		echo '<td><img src="http://fooproject.com.au/misc/message-16-help.png" alt="No idea" /></td>';
		
		echo '</tr>';
	}
	
	echo '</table>';
}
